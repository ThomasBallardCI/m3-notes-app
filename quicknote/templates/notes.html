{% extends "base.html" %}

<!-- page title block -->
{% block title %} Notes {% endblock %}

<!-- main page content block -->
{% block content %}
<div class="container">
    <h1 class="center-align">Welcome to your notes {{ user.first_name}}</h1>
    <div class="row">
        <div class="col s12 center-align">
            <a href="{{ url_for('add_note') }}" class="waves-effect waves-light btn-large purple darken-4 hoverable">
                <i class="material-icons right">add</i>New Note</a>
        </div>
    </div>

    <ul class="collapsible popout">
        {% for note in notes %}
        <li>
            <div class="collapsible-header hoverable">
                <i class="material-icons">keyboard_arrow_down</i>
                <strong>{{ note.note_title }}</strong>
                <div class="date-right">
                    {% if note.note_date %}
                    <p>{{ note.note_date.strftime('%d/%m/%Y') }}</p>
                    {% endif %}
                </div>
            </div>
            <div class="collapsible-body">
                <p>{{ note.note_content }}</p>
                <a href="{{ url_for('edit_note', note_id=note.id) }}" class="btn-small purple darken-4 hoverable">Edit</a>
                <a class="waves-effect waves-light red btn-small modal-trigger hoverable" href="#modal{{ note.id }}">Delete Note</a>
            </div>

            <!-- Modal Structure for each note -->
            <div id="modal{{ note.id }}" class="modal">
                <div class="modal-content">
                    <h4>Confirmation Required!</h4>
                    <p>Are you sure you want to proceed? If you click "Agree," the note you want to delete will be permanently erased,
                    and cannot be recovered.</p>
                </div>
                <div class="modal-footer">
                    <a href="#!" class="modal-close waves-effect waves-light btn-small white purple-text text-darken-4 hoverable">Cancel</a>
                    <a class="waves-effect waves-light btn-small modal-trigger red delete-button hoverable"
                        href="{{ url_for('delete_note', note_id=note.id) }}" data-note-id="{{ note.id }}">Agree</a>
                </div>
            </div>
        </li>
        {% endfor %}
    </ul>
</div>
{% endblock %}